
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Radiative transfer &#8212; Climate Data Science</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Bibliography" href="../Bibliography.html" />
    <link rel="prev" title="SimpleTrans" href="SimpleTrans.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/DurhamUniversityMasterLogo_RGB.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Climate Data Science</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../An_Aside_On_Python.html">
   An Aside On Python
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Global Carbon Dioxide
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_1/Data_Exploration.html">
   Global
   <span class="math notranslate nohighlight">
    \(\textrm{CO}_2 \)
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_1/Fitting.html">
   Curve Fitting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_1/Hypothesis_Testing.html">
   Hypothesis Testing And Goodness of Fit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_1/Final_Model.html">
   Final Model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Temperature Rise and Predictive Modelling
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_2/predictive_models.html">
   Predictive Modeling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_2/temp_co2.html">
   Global Temperature Predictions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_2/3models.html">
   Implementation of the Three SRES Approximation Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter_2/bayesian_inference.html">
   Using Bayesian Inference to Determine
   <span class="math notranslate nohighlight">
    \(S\)
   </span>
   Left as Work in progress
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Radiation Modelling
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="atmospheric_primer.html">
   Radiation Modelling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lorentzian_broadening.html">
   The Variance of Absorption Spectra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Using_HITRAN.html">
   HITRAN
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="SimpleTrans.html">
   SimpleTrans
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Radiative transfer
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Bibliography.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/seancraven/CDS_book/master?urlpath=tree/docs/Chapter_3/radiative_transfer.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/Chapter_3/radiative_transfer.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Radiative transfer
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grey-gas-model">
   Grey Gas Model
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Radiative transfer</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Radiative transfer
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grey-gas-model">
   Grey Gas Model
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="radiative-transfer">
<h1>Radiative transfer<a class="headerlink" href="#radiative-transfer" title="Permalink to this headline">#</a></h1>
<p>Radiation modelling, is a notorious challenging due to its highly coupled nature. It is important that the goals of our model are defined, such that when approximations are made to simply the problem, the sources of discrepancy can be understood. Throughout the book most of the effort in the chapters has been focused around <span class="math notranslate nohighlight">\(\textrm{CO}_2\)</span>. Therefore, to continue this focus, the radiation model that is developed is focused on modelling the greenhouse effect caused by molecules re-radiating longwave radiation into the atmosphere. We take the only source of radiation to be black body radiation emitted by the earth, assuming it is a perfect black body, at some temperature <span class="math notranslate nohighlight">\(T\)</span> and wavenumber <span class="math notranslate nohighlight">\(\nu\)</span> the spectral radiance is</p>
<div class="math notranslate nohighlight" id="equation-chapter-3-radiative-transfer-0">
<span class="eqno">(32)<a class="headerlink" href="#equation-chapter-3-radiative-transfer-0" title="Permalink to this equation">#</a></span>\[B(T, \nu) = 2hc^2 \nu^3 \frac{1}{e^{hc\nu/(k_bT) - 1}.\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The hitran convention for wavenumber is used wher it is denoted as <span class="math notranslate nohighlight">\(\nu\)</span> rather than <span class="math notranslate nohighlight">\(\tilde{\nu}\)</span> in many texts.</p>
</div>
<p>Additionally, because the effects of incoming solar radiation are not considered, which performs a substantial amount of heating in the stratosphere with absorption of UV by O2, limiting the model to only extend up to 10km enables the model to both avoid warming due to shortwave and relative gas concentration changes.</p>
<p>To start the simplest model of the atmosphere is that it is a single block of some height, from which an observer is looking down perpendicular to and radiation is emitted parallel to the surface. The Beer-Lambert Law describes this</p>
<div class="math notranslate nohighlight" id="equation-chapter-3-radiative-transfer-1">
<span class="eqno">(33)<a class="headerlink" href="#equation-chapter-3-radiative-transfer-1" title="Permalink to this equation">#</a></span>\[-\frac{d}{d \tau_\nu} I(\tau, \hat{n}, \nu) = I(\tau, \hat{n}, \nu).\]</div>
<p>The parameter <span class="math notranslate nohighlight">\(\tau\)</span> is the optical density of the medium. This equation, describes a radiation model that only models the amount of light, which is not scattered by the medium. This is solved by a simple exponential decay, which has decay length inversely proportional to the optical depth of the medium.</p>
<div class="math notranslate nohighlight" id="equation-chapter-3-radiative-transfer-2">
<span class="eqno">(34)<a class="headerlink" href="#equation-chapter-3-radiative-transfer-2" title="Permalink to this equation">#</a></span>\[I = I_0 \exp (-\tau)\]</div>
<p>This is an insufficient model for our use case; firstly, a key behaviour of greenhouse gases is that they re-radiate isotropically, and secondly, they have differing optical depth depending on <a class="reference internal" href="lorentzian_broadening.html"><span class="doc std std-doc">wavenumber</span></a>.</p>
<p>To include the isotropic re-radiation we iterate upon the Beer-Lambert law, with the Schwarzschild equation. The Schwarzschild equation adds a black body radiation term to the Beer-Lambert law, which is dependent on the optical depth of the medium. Further, it is assumed that the incident radiation is incident on the medium with a direction defined by a unit vector <span class="math notranslate nohighlight">\(\hat{n}\)</span></p>
<div class="math notranslate nohighlight" id="equation-chapter-3-radiative-transfer-3">
<span class="eqno">(35)<a class="headerlink" href="#equation-chapter-3-radiative-transfer-3" title="Permalink to this equation">#</a></span>\[\frac{d}{d \tau_nu} I(\tau_{\nu}, \hat{n}, \nu)= -\frac{1}{\cos\theta} [I(\tau_{\nu}, \hat{n}, \nu) - B(T(\tau_{\nu}), \nu)].\]</div>
<p>Where <span class="math notranslate nohighlight">\(\tau = k(\nu, p, T)u\)</span>, <span class="math notranslate nohighlight">\(u\)</span> is the column number density of absorbing species and <span class="math notranslate nohighlight">\(k(\nu, p, T)\)</span> is the absorption coefficient per molecule per unit length. The re-radiation term is the plank function <span class="math notranslate nohighlight">\(B(T(\tau_\nu), \nu)\)</span>. Additionally, the <span class="math notranslate nohighlight">\(\cos \theta\)</span> term comes from the distance through the medium of width <span class="math notranslate nohighlight">\(\delta \tau\)</span>, where , if the path of incoming radiation is at some angle <span class="math notranslate nohighlight">\(\theta\)</span> to the perpendicular from the surface, the distance the radiation travels is further <span class="math notranslate nohighlight">\(\delta \tau / \cos \theta\)</span>, as seen in the figure below from<span id="id1">[<a class="reference internal" href="../Bibliography.html#id32" title="Raymond T. Pierrehumbert. Principles of Planetary Climate. Cambridge University Press, 2010. doi:10.1017/CBO9780511780783.">Pie10</a>]</span>. This model is taken from sections of chapter 4 in <span class="math notranslate nohighlight">\(principles of planetary climate\)</span><span id="id2">[]</span>.</p>
<img alt="../_images/Schwarzchild.png" class="align-center" src="../_images/Schwarzchild.png" />
<p>If it is assumed that the radiation incoming and outgoing is isotropic as is emitted black body radiation, then the directional dependence of the equation is removed. The Solution can then be integrated over a hemisphere,and two separate ordinary differential equations for upward and downward propagating flux can be performed, assuming that <span class="math notranslate nohighlight">\(\cos \bar{\theta} = 1/2\)</span></p>
<div class="amsmath math notranslate nohighlight" id="equation-5dbb3f6e-22b0-48f2-9fec-2b2751449060">
<span class="eqno">(36)<a class="headerlink" href="#equation-5dbb3f6e-22b0-48f2-9fec-2b2751449060" title="Permalink to this equation">#</a></span>\[\begin{align}
\int_0^{\pi/2}I(T(\tau_{\nu}),\nu) d\Omega &amp;= \int_0^{\pi/2} -\frac{1}{\cos\theta} [I(\tau_{\nu}, \hat{n}, \nu) - B(T(\tau_{\nu}), \nu)] d\Omega, \\
\frac{d}{d \tau_{\nu}} I_+ &amp;= - I_+ + \pi B(T_{\nu}, \nu).
\end{align}\]</div>
<p><span class="math notranslate nohighlight">\(I_+\)</span> is all the radiation in the upward direction from the block of atmosphere. In the downward direction <span class="math notranslate nohighlight">\(I_-\)</span>, the equation is similar</p>
<div class="amsmath math notranslate nohighlight" id="equation-f4df838e-26a3-4061-a0e9-3321b5053035">
<span class="eqno">(37)<a class="headerlink" href="#equation-f4df838e-26a3-4061-a0e9-3321b5053035" title="Permalink to this equation">#</a></span>\[\begin{align}
\int_{\pi/2}^{\pi}I(T(\tau_{\nu}), \nu) d\Omega &amp;= \int_{\pi/2}^{\pi} -\frac{1}{\cos\theta} [I(\tau_{\nu}, \hat{n}, \nu) - B(T(\tau_{\nu}), \nu)] d\Omega, \\
\frac{d}{d \tau_{\nu}} I_- &amp;=  I_- - \pi B(T_{\nu}, \nu).
\end{align}\]</div>
<p>As the temperature of the radiation block is a function of the atmosphereâ€™s optical depth, Ideally it should be calculated, rather than taken from the ISA model. However, this is deceptively difficult. Often, atmospheres are not in just radiative equilibrium, because they are comprised of gases convection plays a key role in energy transfer as well, thus blocks of atmosphere may infect heat, and not be in radiative equilibrium with their surroundings. A model which includes, convection is much better approximated by an adiabatic atmosphere where warm blocks of air rise, expand and cool adiabatically. This, is typically the assumption for the lower atmosphere, <a class="reference external" href="https://ereader.cambridge.org/wr/viewer.html#book/95232efd-fe8e-4b72-ad9e-c3f22d2a0cda/ichap4/pos_1.4427424769341008">troposphere</a><span id="id3">[<a class="reference internal" href="../Bibliography.html#id32" title="Raymond T. Pierrehumbert. Principles of Planetary Climate. Cambridge University Press, 2010. doi:10.1017/CBO9780511780783.">Pie10</a>]</span>. For higher altitudes, convection is less important and radiative equilibrium provides a better approximation.</p>
<p>Despite, it not being a good approximation, for the lower atmosphere, radiative equilibrium provides a more straightforward path to a solution. With this boundary condition two equations for the upwards and downward spectral radiance can be formed:</p>
<div class="amsmath math notranslate nohighlight" id="equation-752da615-548e-497c-9a4c-fc04cfdb4554">
<span class="eqno">(38)<a class="headerlink" href="#equation-752da615-548e-497c-9a4c-fc04cfdb4554" title="Permalink to this equation">#</a></span>\[\begin{align}
0 = \frac{d}{d \tau_{\nu}}I_+ - I_- &amp;= -(I_+ + I_-) + 2 \pi B(T(\tau_{\nu}, \nu), \\
 \frac{d}{d \tau_{\nu}}I_+ + I_- &amp;= -(I_+ - I_-).
\end{align}\]</div>
<p>As an initial start point, a grey gas atmosphere is considered. This is where optical depth is independent of wavenumber.</p>
</section>
<section id="grey-gas-model">
<h1>Grey Gas Model<a class="headerlink" href="#grey-gas-model" title="Permalink to this headline">#</a></h1>
<p>With wavenumber independence, we can consider the total flux given by the integral over the integral over wavenumber and solid angle of the plank function which gives the Stephan-Boltzmann law</p>
<div class="math notranslate nohighlight" id="equation-chapter-3-radiative-transfer-4">
<span class="eqno">(39)<a class="headerlink" href="#equation-chapter-3-radiative-transfer-4" title="Permalink to this equation">#</a></span>\[\sigma T^4 = \int \int d \Omega d \nu B(T,\nu).\]</div>
<p>With the solution to eq.<code class="xref eq docutils literal notranslate"><span class="pre">label</span></code> now,</p>
<div class="math notranslate nohighlight" id="equation-chapter-3-radiative-transfer-5">
<span class="eqno">(40)<a class="headerlink" href="#equation-chapter-3-radiative-transfer-5" title="Permalink to this equation">#</a></span>\[I_+ - I_- = C,\]</div>
<p>Thus</p>
<div class="math notranslate nohighlight" id="equation-chapter-3-radiative-transfer-6">
<span class="eqno">(41)<a class="headerlink" href="#equation-chapter-3-radiative-transfer-6" title="Permalink to this equation">#</a></span>\[I_+ + I_- = -c \tau + c'\]</div>
<p>Using the boundary condition that the outgoing longwave radiation(OLR) at the top of the atmosphere is a constant <span class="math notranslate nohighlight">\(I_{OLR}\)</span></p>
<div class="math notranslate nohighlight" id="equation-specific-solution">
<span class="eqno">(42)<a class="headerlink" href="#equation-specific-solution" title="Permalink to this equation">#</a></span>\[I_+ + I_- = c' - c\tau_{\infty} = I_{OLR},\]</div>
<p>Then</p>
<div class="amsmath math notranslate nohighlight" id="equation-db284941-7bdd-49ee-8e2c-d52822166016">
<span class="eqno">(43)<a class="headerlink" href="#equation-db284941-7bdd-49ee-8e2c-d52822166016" title="Permalink to this equation">#</a></span>\[\begin{align}
c &amp;= I_{OLR}, \\
c' &amp;= I_{OLR}(\tau_{\infty} + 1).
\end{align}\]</div>
<p>Finally, substituting into eq.<a class="reference internal" href="#equation-specific-solution">(42)</a></p>
<div class="math notranslate nohighlight" id="equation-chapter-3-radiative-transfer-7">
<span class="eqno">(44)<a class="headerlink" href="#equation-chapter-3-radiative-transfer-7" title="Permalink to this equation">#</a></span>\[T = \left(\frac{(1 + \tau_{\infty} - \tau)I_{\infty}}{2 \sigma} \right)^{1/4}.\]</div>
<p>This gives us the expression for the Grey Gas at zero altitude. A comparison between this and the surface temperature of the planet is plotted below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">isa</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">scipy.constants</span> <span class="k">as</span> <span class="nn">cst</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
<span class="kn">from</span> <span class="nn">dur_utils</span> <span class="kn">import</span> <span class="n">colours</span>

<span class="n">mpl</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;../CDS.mplstyle&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="nn">Input In [1],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;matplotlib&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">max_alt</span> <span class="o">=</span> <span class="mi">10000</span>  <span class="c1"># Alt strat stop</span>
<span class="n">SBC</span> <span class="o">=</span> <span class="n">cst</span><span class="o">.</span><span class="n">physical_constants</span><span class="p">[</span><span class="s2">&quot;Stefan-Boltzmann constant&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">olr</span> <span class="o">=</span> <span class="n">SBC</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">isa</span><span class="o">.</span><span class="n">get_temperature</span><span class="p">(</span><span class="n">max_alt</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span>
<span class="n">points</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">altitudes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_alt</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">taus_inf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">isa_temp_profile</span> <span class="o">=</span> <span class="n">isa</span><span class="o">.</span><span class="n">get_temperature</span><span class="p">(</span><span class="n">altitudes</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">ground_gas_temp</span><span class="p">(</span><span class="n">tau_inf</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the ground temperature for a particular optical thickness of the</span>
<span class="sd">    whole atmosphere tau_infinity.</span>
<span class="sd">    Args:</span>
<span class="sd">        tau_inf: The total optical Thickness of the atmosphere.</span>

<span class="sd">    Returns:</span>
<span class="sd">        t_ground</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t_ground</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">tau_inf</span><span class="p">)</span> <span class="o">*</span> <span class="n">olr</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">SBC</span><span class="p">))</span> <span class="o">**</span> <span class="mf">0.25</span>
    <span class="k">return</span> <span class="n">t_ground</span>


<span class="k">def</span> <span class="nf">ground_temp</span><span class="p">(</span><span class="n">tau_inf</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns The surface temperature of the planet assuming radiative equilibruim as a function of</span>
<span class="sd">    Args:</span>
<span class="sd">        tau_inf:</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t_ground</span> <span class="o">=</span> <span class="p">((</span><span class="mi">2</span> <span class="o">+</span> <span class="n">tau_inf</span><span class="p">)</span> <span class="o">*</span> <span class="n">olr</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">SBC</span><span class="p">))</span> <span class="o">**</span> <span class="mf">0.25</span>
    <span class="k">return</span> <span class="n">t_ground</span>


<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span>
    <span class="n">taus_inf</span><span class="p">,</span>
    <span class="n">ground_gas_temp</span><span class="p">(</span><span class="n">taus_inf</span><span class="p">),</span>
    <span class="n">c</span><span class="o">=</span><span class="n">colours</span><span class="o">.</span><span class="n">durham</span><span class="o">.</span><span class="n">ink</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Grey gas temperature at ground level&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span>
    <span class="n">taus_inf</span><span class="p">,</span>
    <span class="n">ground_temp</span><span class="p">(</span><span class="n">taus_inf</span><span class="p">),</span>
    <span class="n">c</span><span class="o">=</span><span class="n">colours</span><span class="o">.</span><span class="n">durham</span><span class="o">.</span><span class="n">purple</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Surface Temperature&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span>
    <span class="n">taus_inf</span><span class="p">,</span>
    <span class="p">[</span><span class="n">isa</span><span class="o">.</span><span class="n">get_temperature</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">taus_inf</span><span class="p">],</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
    <span class="n">c</span><span class="o">=</span><span class="n">colours</span><span class="o">.</span><span class="n">durham</span><span class="o">.</span><span class="n">ink</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Earth Surface Temperature&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Total atmosphere optical thickness: $\tau_{\infty}$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Temperature (K)&quot;</span><span class="p">)</span><span class="n">i</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Temperature (K)&#39;)
</pre></div>
</div>
<img alt="../_images/radiative_transfer_2_1.png" src="../_images/radiative_transfer_2_1.png" />
</div>
</div>
<p>As the optical thickness of the atmosphere increases the surface temperature and the Grey Gas surface temperature approach each other, reducing the need for convection.</p>
<div class="math notranslate nohighlight" id="equation-chapter-3-radiative-transfer-8">
<span class="eqno">(45)<a class="headerlink" href="#equation-chapter-3-radiative-transfer-8" title="Permalink to this equation">#</a></span>\[T(0) = \left[\frac{(1 + \tau_{\infty})I_{OLR}}{2 \sigma} \right]^{1/4}\]</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Chapter_3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="SimpleTrans.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">SimpleTrans</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../Bibliography.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Bibliography</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Sean Craven<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>